# -----------------------------------------------------------------------------
# Copyright (c) 2025 Souzan Hammadi. All rights reserved.

"""
**energy.py**

Thermodynamic free energy descriptions
Spline interpolations used in DOI: 10.1039/d5ta08057f

Contains functions: regsol(rtv,om,c), CALPHAD_spl(c, vm, H), ML_spl(c, vm, H), regsol_spl(c, vm, H)
replace fdens in input.py
"""

import ufl
import dolfin as df

def plog(c, tol):
    Δc = c - tol

    t0 = df.ln(tol)
    t1 = Δc / tol
    t2 = -(Δc**2) / (2 * tol**2)
    t3 = Δc**3 / (3 * tol**3)

    return ufl.conditional(ufl.lt(c, tol), t0 + t1 + t2 + t3, df.ln(c))

def regsol(rtv, om, c):
    entropy = rtv * (c * plog(c, 1e-3) + (1 - c) * plog(1 - c, 1e-3))
    enthalpy = om * c * (1 - c)

    return entropy + enthalpy

def CALPHAD_spl(c, vm, H):

    P1 = -38227.3930767077*c**3 + 1565.17808368015*c**2 - 22.5446979307948*c - 0.000978371982781549
    P2 = -9304.24548360343*c**3 + 644.896114808655*c**2 - 12.7841315942789*c - 0.0354854246876357
    P3 = 170.877825755952*c**3 + 50.5474708579303*c**2 - 0.356841766218274*c - 0.122099868943816
    P4 = -1681.46029731626*c**3 + 223.99367692742*c**2 - 5.77046577384172*c - 0.0657763060362183
    P5 = 169.084834106297*c**3 - 6.48330762247997*c**2 + 3.79782116050263*c - 0.198185933309468
    P6 = -206.792007551139*c**3 + 51.9484559442667*c**2 + 0.769993412043945*c - 0.145887090381545
    P7 = -113.742705678844*c**3 + 34.6074496862466*c**2 + 1.84723774019352*c - 0.168193664853328
    P8 = -101.784931488095*c**3 + 32.00935147571*c**2 + 2.03540303483527*c - 0.172736241158317
    P9 = -56.1456866909211*c**3 + 20.6825207215043*c**2 + 2.97244085177488*c - 0.198575768837546
    P10 = -66.2699064342742*c**3 + 23.5080984135129*c**2 + 2.70957650285163*c - 0.190424318825485
    P11 = -63.5599720738101*c**3 + 22.6680187617712*c**2 + 2.79638473353043*c - 0.193414380104457
    P12 = -64.2754899476713*c**3 + 22.9119453096646*c**2 + 2.76866580763317*c - 0.192364420790113
    P13 = -64.1233523291012*c**3 + 22.8553777769448*c**2 + 2.77567675335649*c - 0.192654064911437
    P14 = -64.0163846933428*c**3 + 22.8122989927215*c**2 + 2.78145975378357*c - 0.192912839577076
    P15 = -64.5963937062043*c**3 + 23.0638119919313*c**2 + 2.74510469298821*c - 0.191161186647719
    P16 = -62.3833262299013*c**3 + 22.0357415551989*c**2 + 2.90429984243383*c - 0.199378229209913
    P17 = -70.6555824985553*c**3 + 26.1342685246927*c**2 + 2.22742190352437*c - 0.162115756815979
    P18 = -17.1572317503887*c**3 - 2.02531791460206*c**2 + 7.16814934243121*c - 0.451073452485048
    P19 = 3.25988811071147*c**3 - 13.403221982604*c**2 + 9.28168121930321*c - 0.58194163839687
    P20 = -1.79331678063318*c**3 - 10.4310187419615*c**2 + 8.6989492506018*c - 0.543858044077638
    P21 = -0.439317705109715*c**3 - 11.2692672605917*c**2 + 8.87193326308261*c - 0.555757247360816
    P22 = -0.802114063815679*c**3 - 11.0334496273572*c**2 + 8.82083944255282*c - 0.552067138100483
    P23 = -0.704909767518984*c**3 - 11.099636916435*c**2 + 8.83586195150201*c - 0.553203689535621
    P24 = -0.730950316559756*c**3 - 11.0811007801094*c**2 + 8.83146383189523*c - 0.552855838255027
    P25 = -0.723976394510828*c**3 - 11.086280502248*c**2 + 8.83274620548764*c - 0.552961666463489
    P26 = -0.725846028071828*c**3 - 11.0848340857337*c**2 + 8.83237320538683*c - 0.552929603521079
    P27 = -0.725334024609765*c**3 - 11.0852460157621*c**2 + 8.83248367751366*c - 0.552939479063298
    P28 = -0.725498456886271*c**3 - 11.0851086401381*c**2 + 8.83244542045577*c - 0.552935927726139
    P29 = -0.725416933273664*c**3 - 11.0851792692265*c**2 + 8.83246581729327*c - 0.552937891176953
    P30 = -0.725463093491271*c**3 - 11.085137850896*c**2 + 8.83245342948067*c - 0.552936656153179
    P31 = -0.72545148836798*c**3 - 11.0851486227475*c**2 + 8.83245676218212*c - 0.552936999856684
    P32 = -0.725448746001348*c**3 - 11.0851512527734*c**2 + 8.83245760300633*c - 0.552937089459192
    P33 = -0.725445334857795*c**3 - 11.0851546297781*c**2 + 8.83245871742838*c - 0.552937212049073
    P34 = -0.725437807443086*c**3 - 11.0851623144699*c**2 + 8.83246133264038*c - 0.55293750869896
    P35 = -0.72547323643812*c**3 - 11.0851250498381*c**2 + 8.83244826734153*c - 0.55293598177559
    P36 = -0.725436233420623*c**3 - 11.0851651138219*c**2 + 8.83246272680117*c - 0.552937721293347
    P37 = -0.725445550138829*c**3 - 11.0851547385391*c**2 + 8.83245887531666*c - 0.55293724472358
    P38 = -0.725466421223246*c**3 - 11.0851308505516*c**2 + 8.8324497618305*c - 0.552936085738111
    P39 = -0.7254042091663*c**3 - 11.0852039778547*c**2 + 8.83247841442062*c - 0.552939827943192
    P40 = -0.725565973203629*c**3 - 11.0850088318111*c**2 + 8.83239994195173*c - 0.552929309462343
    P41 = -0.725101804709993*c**3 - 11.0855831346416*c**2 + 8.83263679841184*c - 0.552961871242587
    P42 = -0.726640321459854*c**3 - 11.0836320157396*c**2 + 8.83181200722174*c - 0.552845650669042
    P43 = -0.721076094254386*c**3 - 11.0908604528813*c**2 + 8.83494213952508*c - 0.553297464717616
    P44 = -0.741856521082809*c**3 - 11.0632224850706*c**2 + 8.82268930709688*c - 0.551486768379618
    P45 = -0.664030004554661*c**3 - 11.1691372990608*c**2 + 8.87073611826054*c - 0.558752028586241
    P46 = -0.954773721983656*c**3 - 10.7644749068131*c**2 + 8.68299729333376*c - 0.52971888303
    P47 = 0.130514707387192*c**3 - 12.3085443539603*c**2 + 9.415260531081*c - 0.645475647394051
    P48 = -3.92006853499333*c**3 - 6.42046925899922*c**2 + 6.56222050773795*c - 0.184666455752449
    P49 = 11.3619268116308*c**3 - 29.1072859870037*c**2 + 17.7887573916523*c - 2.03647804478169
    P50 = 172.46367273436*c**3 - 273.24965912677*c**2 + 141.117647095758*c - 22.8030698768052
    P51 = 160.836213628179*c**3 - 255.269379181293*c**2 + 131.84963006941*c - 21.2106560422617
    P52 = 166.017592720396*c**3 - 263.4418271131*c**2 + 136.146356482102*c - 21.963668196393
    P53 = 156.919110500326*c**3 - 248.809813433618*c**2 + 128.302710361182*c - 20.5621116319599
    P54 = 247.314456737498*c**3 - 396.976003675285*c**2 + 209.255328847765*c - 35.3053006351183
    P55 = 263.628441990426*c**3 - 424.220359047758*c**2 + 224.42135333833*c - 38.1194407350449
    P56 = 249.791438065193*c**3 - 400.684873280203*c**2 + 211.077446104711*c - 35.5975770548503
    P57 = 289.121223642782*c**3 - 468.796911030484*c**2 + 250.396667896915*c - 43.1635485209044
    P58 = -228.29439763166*c**3 + 443.265715925256*c**2 - 285.509221093045*c + 61.798221049954
    P59 = -283.419370077594*c**3 + 542.13987104845*c**2 - 344.623981110664*c + 73.5793747383432
    P60 = -268.206399221133*c**3 + 514.383114222088*c**2 - 327.742826277317*c + 70.1571042584546
    P61 = -274.639818123935*c**3 + 526.320030568109*c**2 - 335.125628174894*c + 71.6791546294808
    P62 = -264.118911722253*c**3 + 506.473775310675*c**2 - 322.646543429495*c + 69.0635888874167
    P63 = -299.768939329224*c**3 + 574.82460096787*c**2 - 366.328934736055*c + 78.3692619445137
    P64 = -130.854361800739*c**3 + 245.748292201024*c**2 - 152.628774224664*c + 32.1107322499738
    P65 = 29.1691028181085*c**3 - 70.9526918671327*c**2 + 56.2979052652954*c - 13.8320335327953
    P66 = -5.17863478595973*c**3 - 1.91373928333633*c**2 + 10.0418070339656*c - 3.50150492780085
    P67 = 3.94841327708855*c**3 - 20.5412146481976*c**2 + 22.7141349716403*c - 6.37517929348542
    P68 = 1.78836619075446*c**3 - 16.0659898210724*c**2 + 19.6235175834154*c - 5.6637129270166
    P69 = 1.30081165237061*c**3 - 15.0407955964329*c**2 + 18.9049496312218*c - 5.49582932371413
    P70 = 5.4118183923274*c**3 - 23.8121890679176*c**2 + 25.143270988221*c - 6.97475257870974
    P71 = -16.4125736478163*c**3 + 23.4276995207765*c**2 - 8.94102438434493*c + 1.2226926013027
    P72 = -32.6584338127141*c**3 + 59.0947470650135*c**2 - 35.0428182687319*c + 7.58994838222861
    P73 = -28.821384660172*c**3 + 50.5520803607069*c**2 - 28.7031240995857*c + 6.02167454175651
    P74 = -30.4650576611893*c**3 + 54.2622985982453*c**2 - 31.4947822463291*c + 6.72184496380942
    P75 = -27.7272249666712*c**3 + 47.9976396054553*c**2 - 26.7165559779678*c + 5.50701713377202
    P76 = -37.0344549047732*c**3 + 69.5819519436918*c**2 - 43.4018834858434*c + 9.80643839358527
    P77 = 5.71566847014765*c**3 - 30.8808379873226*c**2 + 35.2939686269383*c - 10.7419229914012
    P78 = 52.1069107475632*c**3 - 141.334168464207*c**2 + 122.953748178057*c - 33.9319192181065
    P79 = 42.4576288251556*c**3 - 118.061854882282*c**2 + 104.244218501466*c - 28.9181432350815
    P80 = 45.0430263679737*c**3 - 124.377275970881*c**2 + 109.38650227891*c - 30.3138317714111
    P81 = 44.3501638454909*c**3 - 122.663386040484*c**2 + 107.97332212716*c - 29.9254213478562
    P82 = 44.5358906923066*c**3 - 123.128547370259*c**2 + 108.36166135862*c - 30.0334894875559
    P83 = 44.4866750689034*c**3 - 123.003763394256*c**2 + 108.256199992102*c - 30.0037792096555
    P84 = 44.4971247861249*c**3 - 123.030581168539*c**2 + 108.279141379011*c - 30.0103209809022
    P85 = 44.5048056508822*c**3 - 123.050530469118*c**2 + 108.296412637035*c - 30.0153052217138
    P86 = 44.4637021410163*c**3 - 122.94250297187*c**2 + 108.201774002475*c - 29.9876688285221
    P87 = 44.6202198496394*c**3 - 123.358697787917*c**2 + 108.570673953102*c - 30.0966619957471
    P88 = 44.035434545407*c**3 - 121.785625319513*c**2 + 107.160152306365*c - 29.6750727480121
    P89 = 46.2193173243886*c**3 - 127.727771826278*c**2 + 112.549499122953*c - 31.3043974977281
    P90 = 85.7809220301533*c**3 - 236.594114957546*c**2 + 212.409626595183*c - 61.8373879884639
    P91 = 99.2068289951512*c**3 - 273.954752430192*c**2 + 247.064448202333*c - 72.5523787904444
    P92 = 45.5295024005973*c**3 - 122.926274420959*c**2 + 105.418042311863*c - 28.2699923024593
    P93 = 247.952472481706*c**3 - 698.727613860763*c**2 + 651.38240325341*c - 200.827819109143
    P94 = 3392.82248622302*c**3 - 9741.65838973694*c**2 + 9318.89453782806*c - 2970.05417079192
    P95 = 3233.01987300585*c**3 - 9277.21388568662*c**2 + 8868.94633193449*c - 2824.75271480791
    P96 = 3275.63388902869*c**3 - 9402.38287275011*c**2 + 8991.49814926845*c - 2864.749171556
    P97 = 3264.98038066969*c**3 - 9370.7613229391*c**2 + 8960.2119795312*c - 2854.43105598104

    f = ufl.conditional(ufl.le(c, 0.0106060606060606), P1*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0106060606060606), ufl.le(c, 0.0209090909090909)), P2*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0209090909090909), ufl.le(c, 0.0312121212121212)), P3*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0312121212121212), ufl.le(c, 0.0415151515151515)), P4*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0415151515151515), ufl.le(c, 0.0518181818181818)), P5*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0518181818181818), ufl.le(c, 0.0621212121212121)), P6*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0621212121212121), ufl.le(c, 0.0724242424242424)), P7*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0724242424242424), ufl.le(c, 0.0827272727272727)), P8*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0827272727272727), ufl.le(c, 0.093030303030303)), P9*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.093030303030303), ufl.le(c, 0.103333333333333)), P10*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.103333333333333), ufl.le(c, 0.113636363636364)), P11*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.113636363636364), ufl.le(c, 0.123939393939394)), P12*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.123939393939394), ufl.le(c, 0.134242424242424)), P13*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.134242424242424), ufl.le(c, 0.144545454545455)), P14*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.144545454545455), ufl.le(c, 0.154848484848485)), P15*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.154848484848485), ufl.le(c, 0.165151515151515)), P16*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.165151515151515), ufl.le(c, 0.175454545454545)), P17*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.175454545454545), ufl.le(c, 0.185757575757576)), P18*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.185757575757576), ufl.le(c, 0.196060606060606)), P19*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.196060606060606), ufl.le(c, 0.206363636363636)), P20*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.206363636363636), ufl.le(c, 0.216666666666667)), P21*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.216666666666667), ufl.le(c, 0.226969696969697)), P22*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.226969696969697), ufl.le(c, 0.237272727272727)), P23*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.237272727272727), ufl.le(c, 0.247575757575758)), P24*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.247575757575758), ufl.le(c, 0.257878787878788)), P25*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.257878787878788), ufl.le(c, 0.268181818181818)), P26*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.268181818181818), ufl.le(c, 0.278484848484849)), P27*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.278484848484849), ufl.le(c, 0.288787878787879)), P28*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.288787878787879), ufl.le(c, 0.299090909090909)), P29*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.299090909090909), ufl.le(c, 0.309393939393939)), P30*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.309393939393939), ufl.le(c, 0.31969696969697)), P31*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.31969696969697), ufl.le(c, 0.33)), P32*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.33), ufl.le(c, 0.34030303030303)), P33*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.34030303030303), ufl.le(c, 0.350606060606061)), P34*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.350606060606061), ufl.le(c, 0.360909090909091)), P35*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.360909090909091), ufl.le(c, 0.371212121212121)), P36*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.371212121212121), ufl.le(c, 0.381515151515152)), P37*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.381515151515152), ufl.le(c, 0.391818181818182)), P38*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.391818181818182), ufl.le(c, 0.402121212121212)), P39*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.402121212121212), ufl.le(c, 0.412424242424242)), P40*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.412424242424242), ufl.le(c, 0.422727272727273)), P41*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.422727272727273), ufl.le(c, 0.433030303030303)), P42*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.433030303030303), ufl.le(c, 0.443333333333333)), P43*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.443333333333333), ufl.le(c, 0.453636363636364)), P44*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.453636363636364), ufl.le(c, 0.463939393939394)), P45*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.463939393939394), ufl.le(c, 0.474242424242424)), P46*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.474242424242424), ufl.le(c, 0.484545454545455)), P47*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.484545454545455), ufl.le(c, 0.494848484848485)), P48*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.494848484848485), ufl.le(c, 0.505151515151515)), P49*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.505151515151515), ufl.le(c, 0.515454545454545)), P50*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.515454545454545), ufl.le(c, 0.525757575757576)), P51*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.525757575757576), ufl.le(c, 0.536060606060606)), P52*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.536060606060606), ufl.le(c, 0.546363636363636)), P53*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.546363636363636), ufl.le(c, 0.556666666666667)), P54*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.556666666666667), ufl.le(c, 0.566969696969697)), P55*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.566969696969697), ufl.le(c, 0.577272727272727)), P56*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.577272727272727), ufl.le(c, 0.587575757575758)), P57*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.587575757575758), ufl.le(c, 0.597878787878788)), P58*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.597878787878788), ufl.le(c, 0.608181818181818)), P59*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.608181818181818), ufl.le(c, 0.618484848484849)), P60*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.618484848484849), ufl.le(c, 0.628787878787879)), P61*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.628787878787879), ufl.le(c, 0.639090909090909)), P62*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.639090909090909), ufl.le(c, 0.649393939393939)), P63*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.649393939393939), ufl.le(c, 0.65969696969697)), P64*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.65969696969697), ufl.le(c, 0.67)), P65*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.67), ufl.le(c, 0.68030303030303)), P66*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.68030303030303), ufl.le(c, 0.690606060606061)), P67*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.690606060606061), ufl.le(c, 0.700909090909091)), P68*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.700909090909091), ufl.le(c, 0.711212121212121)), P69*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.711212121212121), ufl.le(c, 0.721515151515152)), P70*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.721515151515152), ufl.le(c, 0.731818181818182)), P71*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.731818181818182), ufl.le(c, 0.742121212121212)), P72*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.742121212121212), ufl.le(c, 0.752424242424242)), P73*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.752424242424242), ufl.le(c, 0.762727272727273)), P74*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.762727272727273), ufl.le(c, 0.773030303030303)), P75*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.773030303030303), ufl.le(c, 0.783333333333333)), P76*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.783333333333333), ufl.le(c, 0.793636363636364)), P77*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.793636363636364), ufl.le(c, 0.803939393939394)), P78*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.803939393939394), ufl.le(c, 0.814242424242424)), P79*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.814242424242424), ufl.le(c, 0.824545454545455)), P80*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.824545454545455), ufl.le(c, 0.834848484848485)), P81*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.834848484848485), ufl.le(c, 0.845151515151515)), P82*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.845151515151515), ufl.le(c, 0.855454545454545)), P83*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.855454545454545), ufl.le(c, 0.865757575757576)), P84*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.865757575757576), ufl.le(c, 0.876060606060606)), P85*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.876060606060606), ufl.le(c, 0.886363636363636)), P86*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.886363636363636), ufl.le(c, 0.896666666666667)), P87*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.896666666666667), ufl.le(c, 0.906969696969697)), P88*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.906969696969697), ufl.le(c, 0.917272727272727)), P89*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.917272727272727), ufl.le(c, 0.927575757575758)), P90*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.927575757575758), ufl.le(c, 0.937878787878788)), P91*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.937878787878788), ufl.le(c, 0.948181818181818)), P92*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.948181818181818), ufl.le(c, 0.958484848484848)), P93*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.958484848484848), ufl.le(c, 0.968787878787879)), P94*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.968787878787879), ufl.le(c, 0.979090909090909)), P95*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.979090909090909), ufl.le(c, 0.989393939393939)), P96*1e3*(1/vm)/H,P97*1e3*(1/vm)/H))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

     return f


def ML_spl(c):


     return f


def regsol_spl(c):


    return f
