# -----------------------------------------------------------------------------
# Copyright (c) 2025 Souzan Hammadi. All rights reserved.

"""
**energy.py**

Thermodynamic free energy descriptions
Spline interpolations used in DOI: 10.1039/d5ta08057f

Contains functions: regsol(rtv,om,c), CALPHAD_spl(c, vm, H), ML_spl(c, vm, H), regsol_spl(c, vm, H)
replace fdens in input.py
"""

import ufl
import dolfin as df

def plog(c, tol):
    Δc = c - tol

    t0 = df.ln(tol)
    t1 = Δc / tol
    t2 = -(Δc**2) / (2 * tol**2)
    t3 = Δc**3 / (3 * tol**3)

    return ufl.conditional(ufl.lt(c, tol), t0 + t1 + t2 + t3, df.ln(c))

def regsol(rtv, om, c):
    entropy = rtv * (c * plog(c, 1e-3) + (1 - c) * plog(1 - c, 1e-3))
    enthalpy = om * c * (1 - c)

    return entropy + enthalpy

def CALPHAD_spl(c, vm, H):

    P1 = -38227.3930767077*c**3 + 1565.17808368015*c**2 - 22.5446979307948*c - 0.000978371982781549
    P2 = -9304.24548360343*c**3 + 644.896114808655*c**2 - 12.7841315942789*c - 0.0354854246876357
    P3 = 170.877825755952*c**3 + 50.5474708579303*c**2 - 0.356841766218274*c - 0.122099868943816
    P4 = -1681.46029731626*c**3 + 223.99367692742*c**2 - 5.77046577384172*c - 0.0657763060362183
    P5 = 169.084834106297*c**3 - 6.48330762247997*c**2 + 3.79782116050263*c - 0.198185933309468
    P6 = -206.792007551139*c**3 + 51.9484559442667*c**2 + 0.769993412043945*c - 0.145887090381545
    P7 = -113.742705678844*c**3 + 34.6074496862466*c**2 + 1.84723774019352*c - 0.168193664853328
    P8 = -101.784931488095*c**3 + 32.00935147571*c**2 + 2.03540303483527*c - 0.172736241158317
    P9 = -56.1456866909211*c**3 + 20.6825207215043*c**2 + 2.97244085177488*c - 0.198575768837546
    P10 = -66.2699064342742*c**3 + 23.5080984135129*c**2 + 2.70957650285163*c - 0.190424318825485
    P11 = -63.5599720738101*c**3 + 22.6680187617712*c**2 + 2.79638473353043*c - 0.193414380104457
    P12 = -64.2754899476713*c**3 + 22.9119453096646*c**2 + 2.76866580763317*c - 0.192364420790113
    P13 = -64.1233523291012*c**3 + 22.8553777769448*c**2 + 2.77567675335649*c - 0.192654064911437
    P14 = -64.0163846933428*c**3 + 22.8122989927215*c**2 + 2.78145975378357*c - 0.192912839577076
    P15 = -64.5963937062043*c**3 + 23.0638119919313*c**2 + 2.74510469298821*c - 0.191161186647719
    P16 = -62.3833262299013*c**3 + 22.0357415551989*c**2 + 2.90429984243383*c - 0.199378229209913
    P17 = -70.6555824985553*c**3 + 26.1342685246927*c**2 + 2.22742190352437*c - 0.162115756815979
    P18 = -17.1572317503887*c**3 - 2.02531791460206*c**2 + 7.16814934243121*c - 0.451073452485048
    P19 = 3.25988811071147*c**3 - 13.403221982604*c**2 + 9.28168121930321*c - 0.58194163839687
    P20 = -1.79331678063318*c**3 - 10.4310187419615*c**2 + 8.6989492506018*c - 0.543858044077638
    P21 = -0.439317705109715*c**3 - 11.2692672605917*c**2 + 8.87193326308261*c - 0.555757247360816
    P22 = -0.802114063815679*c**3 - 11.0334496273572*c**2 + 8.82083944255282*c - 0.552067138100483
    P23 = -0.704909767518984*c**3 - 11.099636916435*c**2 + 8.83586195150201*c - 0.553203689535621
    P24 = -0.730950316559756*c**3 - 11.0811007801094*c**2 + 8.83146383189523*c - 0.552855838255027
    P25 = -0.723976394510828*c**3 - 11.086280502248*c**2 + 8.83274620548764*c - 0.552961666463489
    P26 = -0.725846028071828*c**3 - 11.0848340857337*c**2 + 8.83237320538683*c - 0.552929603521079
    P27 = -0.725334024609765*c**3 - 11.0852460157621*c**2 + 8.83248367751366*c - 0.552939479063298
    P28 = -0.725498456886271*c**3 - 11.0851086401381*c**2 + 8.83244542045577*c - 0.552935927726139
    P29 = -0.725416933273664*c**3 - 11.0851792692265*c**2 + 8.83246581729327*c - 0.552937891176953
    P30 = -0.725463093491271*c**3 - 11.085137850896*c**2 + 8.83245342948067*c - 0.552936656153179
    P31 = -0.72545148836798*c**3 - 11.0851486227475*c**2 + 8.83245676218212*c - 0.552936999856684
    P32 = -0.725448746001348*c**3 - 11.0851512527734*c**2 + 8.83245760300633*c - 0.552937089459192
    P33 = -0.725445334857795*c**3 - 11.0851546297781*c**2 + 8.83245871742838*c - 0.552937212049073
    P34 = -0.725437807443086*c**3 - 11.0851623144699*c**2 + 8.83246133264038*c - 0.55293750869896
    P35 = -0.72547323643812*c**3 - 11.0851250498381*c**2 + 8.83244826734153*c - 0.55293598177559
    P36 = -0.725436233420623*c**3 - 11.0851651138219*c**2 + 8.83246272680117*c - 0.552937721293347
    P37 = -0.725445550138829*c**3 - 11.0851547385391*c**2 + 8.83245887531666*c - 0.55293724472358
    P38 = -0.725466421223246*c**3 - 11.0851308505516*c**2 + 8.8324497618305*c - 0.552936085738111
    P39 = -0.7254042091663*c**3 - 11.0852039778547*c**2 + 8.83247841442062*c - 0.552939827943192
    P40 = -0.725565973203629*c**3 - 11.0850088318111*c**2 + 8.83239994195173*c - 0.552929309462343
    P41 = -0.725101804709993*c**3 - 11.0855831346416*c**2 + 8.83263679841184*c - 0.552961871242587
    P42 = -0.726640321459854*c**3 - 11.0836320157396*c**2 + 8.83181200722174*c - 0.552845650669042
    P43 = -0.721076094254386*c**3 - 11.0908604528813*c**2 + 8.83494213952508*c - 0.553297464717616
    P44 = -0.741856521082809*c**3 - 11.0632224850706*c**2 + 8.82268930709688*c - 0.551486768379618
    P45 = -0.664030004554661*c**3 - 11.1691372990608*c**2 + 8.87073611826054*c - 0.558752028586241
    P46 = -0.954773721983656*c**3 - 10.7644749068131*c**2 + 8.68299729333376*c - 0.52971888303
    P47 = 0.130514707387192*c**3 - 12.3085443539603*c**2 + 9.415260531081*c - 0.645475647394051
    P48 = -3.92006853499333*c**3 - 6.42046925899922*c**2 + 6.56222050773795*c - 0.184666455752449
    P49 = 11.3619268116308*c**3 - 29.1072859870037*c**2 + 17.7887573916523*c - 2.03647804478169
    P50 = 172.46367273436*c**3 - 273.24965912677*c**2 + 141.117647095758*c - 22.8030698768052
    P51 = 160.836213628179*c**3 - 255.269379181293*c**2 + 131.84963006941*c - 21.2106560422617
    P52 = 166.017592720396*c**3 - 263.4418271131*c**2 + 136.146356482102*c - 21.963668196393
    P53 = 156.919110500326*c**3 - 248.809813433618*c**2 + 128.302710361182*c - 20.5621116319599
    P54 = 247.314456737498*c**3 - 396.976003675285*c**2 + 209.255328847765*c - 35.3053006351183
    P55 = 263.628441990426*c**3 - 424.220359047758*c**2 + 224.42135333833*c - 38.1194407350449
    P56 = 249.791438065193*c**3 - 400.684873280203*c**2 + 211.077446104711*c - 35.5975770548503
    P57 = 289.121223642782*c**3 - 468.796911030484*c**2 + 250.396667896915*c - 43.1635485209044
    P58 = -228.29439763166*c**3 + 443.265715925256*c**2 - 285.509221093045*c + 61.798221049954
    P59 = -283.419370077594*c**3 + 542.13987104845*c**2 - 344.623981110664*c + 73.5793747383432
    P60 = -268.206399221133*c**3 + 514.383114222088*c**2 - 327.742826277317*c + 70.1571042584546
    P61 = -274.639818123935*c**3 + 526.320030568109*c**2 - 335.125628174894*c + 71.6791546294808
    P62 = -264.118911722253*c**3 + 506.473775310675*c**2 - 322.646543429495*c + 69.0635888874167
    P63 = -299.768939329224*c**3 + 574.82460096787*c**2 - 366.328934736055*c + 78.3692619445137
    P64 = -130.854361800739*c**3 + 245.748292201024*c**2 - 152.628774224664*c + 32.1107322499738
    P65 = 29.1691028181085*c**3 - 70.9526918671327*c**2 + 56.2979052652954*c - 13.8320335327953
    P66 = -5.17863478595973*c**3 - 1.91373928333633*c**2 + 10.0418070339656*c - 3.50150492780085
    P67 = 3.94841327708855*c**3 - 20.5412146481976*c**2 + 22.7141349716403*c - 6.37517929348542
    P68 = 1.78836619075446*c**3 - 16.0659898210724*c**2 + 19.6235175834154*c - 5.6637129270166
    P69 = 1.30081165237061*c**3 - 15.0407955964329*c**2 + 18.9049496312218*c - 5.49582932371413
    P70 = 5.4118183923274*c**3 - 23.8121890679176*c**2 + 25.143270988221*c - 6.97475257870974
    P71 = -16.4125736478163*c**3 + 23.4276995207765*c**2 - 8.94102438434493*c + 1.2226926013027
    P72 = -32.6584338127141*c**3 + 59.0947470650135*c**2 - 35.0428182687319*c + 7.58994838222861
    P73 = -28.821384660172*c**3 + 50.5520803607069*c**2 - 28.7031240995857*c + 6.02167454175651
    P74 = -30.4650576611893*c**3 + 54.2622985982453*c**2 - 31.4947822463291*c + 6.72184496380942
    P75 = -27.7272249666712*c**3 + 47.9976396054553*c**2 - 26.7165559779678*c + 5.50701713377202
    P76 = -37.0344549047732*c**3 + 69.5819519436918*c**2 - 43.4018834858434*c + 9.80643839358527
    P77 = 5.71566847014765*c**3 - 30.8808379873226*c**2 + 35.2939686269383*c - 10.7419229914012
    P78 = 52.1069107475632*c**3 - 141.334168464207*c**2 + 122.953748178057*c - 33.9319192181065
    P79 = 42.4576288251556*c**3 - 118.061854882282*c**2 + 104.244218501466*c - 28.9181432350815
    P80 = 45.0430263679737*c**3 - 124.377275970881*c**2 + 109.38650227891*c - 30.3138317714111
    P81 = 44.3501638454909*c**3 - 122.663386040484*c**2 + 107.97332212716*c - 29.9254213478562
    P82 = 44.5358906923066*c**3 - 123.128547370259*c**2 + 108.36166135862*c - 30.0334894875559
    P83 = 44.4866750689034*c**3 - 123.003763394256*c**2 + 108.256199992102*c - 30.0037792096555
    P84 = 44.4971247861249*c**3 - 123.030581168539*c**2 + 108.279141379011*c - 30.0103209809022
    P85 = 44.5048056508822*c**3 - 123.050530469118*c**2 + 108.296412637035*c - 30.0153052217138
    P86 = 44.4637021410163*c**3 - 122.94250297187*c**2 + 108.201774002475*c - 29.9876688285221
    P87 = 44.6202198496394*c**3 - 123.358697787917*c**2 + 108.570673953102*c - 30.0966619957471
    P88 = 44.035434545407*c**3 - 121.785625319513*c**2 + 107.160152306365*c - 29.6750727480121
    P89 = 46.2193173243886*c**3 - 127.727771826278*c**2 + 112.549499122953*c - 31.3043974977281
    P90 = 85.7809220301533*c**3 - 236.594114957546*c**2 + 212.409626595183*c - 61.8373879884639
    P91 = 99.2068289951512*c**3 - 273.954752430192*c**2 + 247.064448202333*c - 72.5523787904444
    P92 = 45.5295024005973*c**3 - 122.926274420959*c**2 + 105.418042311863*c - 28.2699923024593
    P93 = 247.952472481706*c**3 - 698.727613860763*c**2 + 651.38240325341*c - 200.827819109143
    P94 = 3392.82248622302*c**3 - 9741.65838973694*c**2 + 9318.89453782806*c - 2970.05417079192
    P95 = 3233.01987300585*c**3 - 9277.21388568662*c**2 + 8868.94633193449*c - 2824.75271480791
    P96 = 3275.63388902869*c**3 - 9402.38287275011*c**2 + 8991.49814926845*c - 2864.749171556
    P97 = 3264.98038066969*c**3 - 9370.7613229391*c**2 + 8960.2119795312*c - 2854.43105598104

    f = ufl.conditional(ufl.le(c, 0.0106060606060606), P1*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0106060606060606), ufl.le(c, 0.0209090909090909)), P2*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0209090909090909), ufl.le(c, 0.0312121212121212)), P3*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0312121212121212), ufl.le(c, 0.0415151515151515)), P4*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0415151515151515), ufl.le(c, 0.0518181818181818)), P5*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0518181818181818), ufl.le(c, 0.0621212121212121)), P6*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0621212121212121), ufl.le(c, 0.0724242424242424)), P7*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0724242424242424), ufl.le(c, 0.0827272727272727)), P8*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0827272727272727), ufl.le(c, 0.093030303030303)), P9*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.093030303030303), ufl.le(c, 0.103333333333333)), P10*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.103333333333333), ufl.le(c, 0.113636363636364)), P11*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.113636363636364), ufl.le(c, 0.123939393939394)), P12*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.123939393939394), ufl.le(c, 0.134242424242424)), P13*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.134242424242424), ufl.le(c, 0.144545454545455)), P14*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.144545454545455), ufl.le(c, 0.154848484848485)), P15*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.154848484848485), ufl.le(c, 0.165151515151515)), P16*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.165151515151515), ufl.le(c, 0.175454545454545)), P17*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.175454545454545), ufl.le(c, 0.185757575757576)), P18*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.185757575757576), ufl.le(c, 0.196060606060606)), P19*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.196060606060606), ufl.le(c, 0.206363636363636)), P20*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.206363636363636), ufl.le(c, 0.216666666666667)), P21*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.216666666666667), ufl.le(c, 0.226969696969697)), P22*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.226969696969697), ufl.le(c, 0.237272727272727)), P23*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.237272727272727), ufl.le(c, 0.247575757575758)), P24*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.247575757575758), ufl.le(c, 0.257878787878788)), P25*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.257878787878788), ufl.le(c, 0.268181818181818)), P26*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.268181818181818), ufl.le(c, 0.278484848484849)), P27*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.278484848484849), ufl.le(c, 0.288787878787879)), P28*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.288787878787879), ufl.le(c, 0.299090909090909)), P29*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.299090909090909), ufl.le(c, 0.309393939393939)), P30*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.309393939393939), ufl.le(c, 0.31969696969697)), P31*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.31969696969697), ufl.le(c, 0.33)), P32*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.33), ufl.le(c, 0.34030303030303)), P33*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.34030303030303), ufl.le(c, 0.350606060606061)), P34*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.350606060606061), ufl.le(c, 0.360909090909091)), P35*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.360909090909091), ufl.le(c, 0.371212121212121)), P36*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.371212121212121), ufl.le(c, 0.381515151515152)), P37*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.381515151515152), ufl.le(c, 0.391818181818182)), P38*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.391818181818182), ufl.le(c, 0.402121212121212)), P39*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.402121212121212), ufl.le(c, 0.412424242424242)), P40*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.412424242424242), ufl.le(c, 0.422727272727273)), P41*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.422727272727273), ufl.le(c, 0.433030303030303)), P42*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.433030303030303), ufl.le(c, 0.443333333333333)), P43*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.443333333333333), ufl.le(c, 0.453636363636364)), P44*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.453636363636364), ufl.le(c, 0.463939393939394)), P45*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.463939393939394), ufl.le(c, 0.474242424242424)), P46*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.474242424242424), ufl.le(c, 0.484545454545455)), P47*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.484545454545455), ufl.le(c, 0.494848484848485)), P48*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.494848484848485), ufl.le(c, 0.505151515151515)), P49*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.505151515151515), ufl.le(c, 0.515454545454545)), P50*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.515454545454545), ufl.le(c, 0.525757575757576)), P51*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.525757575757576), ufl.le(c, 0.536060606060606)), P52*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.536060606060606), ufl.le(c, 0.546363636363636)), P53*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.546363636363636), ufl.le(c, 0.556666666666667)), P54*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.556666666666667), ufl.le(c, 0.566969696969697)), P55*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.566969696969697), ufl.le(c, 0.577272727272727)), P56*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.577272727272727), ufl.le(c, 0.587575757575758)), P57*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.587575757575758), ufl.le(c, 0.597878787878788)), P58*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.597878787878788), ufl.le(c, 0.608181818181818)), P59*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.608181818181818), ufl.le(c, 0.618484848484849)), P60*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.618484848484849), ufl.le(c, 0.628787878787879)), P61*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.628787878787879), ufl.le(c, 0.639090909090909)), P62*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.639090909090909), ufl.le(c, 0.649393939393939)), P63*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.649393939393939), ufl.le(c, 0.65969696969697)), P64*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.65969696969697), ufl.le(c, 0.67)), P65*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.67), ufl.le(c, 0.68030303030303)), P66*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.68030303030303), ufl.le(c, 0.690606060606061)), P67*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.690606060606061), ufl.le(c, 0.700909090909091)), P68*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.700909090909091), ufl.le(c, 0.711212121212121)), P69*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.711212121212121), ufl.le(c, 0.721515151515152)), P70*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.721515151515152), ufl.le(c, 0.731818181818182)), P71*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.731818181818182), ufl.le(c, 0.742121212121212)), P72*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.742121212121212), ufl.le(c, 0.752424242424242)), P73*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.752424242424242), ufl.le(c, 0.762727272727273)), P74*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.762727272727273), ufl.le(c, 0.773030303030303)), P75*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.773030303030303), ufl.le(c, 0.783333333333333)), P76*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.783333333333333), ufl.le(c, 0.793636363636364)), P77*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.793636363636364), ufl.le(c, 0.803939393939394)), P78*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.803939393939394), ufl.le(c, 0.814242424242424)), P79*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.814242424242424), ufl.le(c, 0.824545454545455)), P80*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.824545454545455), ufl.le(c, 0.834848484848485)), P81*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.834848484848485), ufl.le(c, 0.845151515151515)), P82*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.845151515151515), ufl.le(c, 0.855454545454545)), P83*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.855454545454545), ufl.le(c, 0.865757575757576)), P84*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.865757575757576), ufl.le(c, 0.876060606060606)), P85*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.876060606060606), ufl.le(c, 0.886363636363636)), P86*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.886363636363636), ufl.le(c, 0.896666666666667)), P87*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.896666666666667), ufl.le(c, 0.906969696969697)), P88*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.906969696969697), ufl.le(c, 0.917272727272727)), P89*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.917272727272727), ufl.le(c, 0.927575757575758)), P90*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.927575757575758), ufl.le(c, 0.937878787878788)), P91*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.937878787878788), ufl.le(c, 0.948181818181818)), P92*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.948181818181818), ufl.le(c, 0.958484848484848)), P93*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.958484848484848), ufl.le(c, 0.968787878787879)), P94*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.968787878787879), ufl.le(c, 0.979090909090909)), P95*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.979090909090909), ufl.le(c, 0.989393939393939)), P96*1e3*(1/vm)/H,P97*1e3*(1/vm)/H))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

     return f


def ML_spl(c):
    P1 =  -2550.90347151372*c**3 + 343.511278398915*c**2 - 3.24142590865911*c - 0.00020245621176464
    P2 = -2539.35023299365*c**3 + 343.143675355094*c**2 - 3.23752708849738*c - 0.00021623991940713
    P3 = -2585.56318707411*c**3 + 346.042487929234*c**2 - 3.29813862413845*c + 0.000206204116879161
    P4 = -2410.80135326472*c**3 + 329.6784253089*c**2 - 2.78738151810984*c - 0.00510773345089333
    P5 = -268.322072686904*c**3 + 62.8423694551147*c**2 + 8.29035777036557*c - 0.15840574178636
    P6 = -399.165522369847*c**3 + 83.1825784512821*c**2 + 7.23636512238204*c - 0.140200414230289
    P7 = -364.364817819005*c**3 + 76.6969926031561*c**2 + 7.63925757658308*c - 0.148543136766751
    P8 = -372.724169496534*c**3 + 78.513251740369*c**2 + 7.50771638452488*c - 0.145367546372619
    P9 = -15.5420235844504*c**3 - 10.1328626541508*c**2 + 14.8411676662563*c - 0.347593021111265
    P10 = -17.2440760367317*c**3 - 9.65783528797328*c**2 + 14.7969757264318*c - 0.346222624593366
    P11 = -16.7880001533777*c**3 - 9.79921881177142*c**2 + 14.8115853572208*c - 0.346725845209676
    P12 = -16.9102518482541*c**3 - 9.75754209763545*c**2 + 14.8068493669798*c - 0.346546451639711
    P13 = -16.8773191002256*c**3 - 9.76978709214018*c**2 + 14.808367004176*c - 0.346609149984658
    P14 = -16.8867978187627*c**3 - 9.76596975368739*c**2 + 14.807854555409*c - 0.346586219196297
    P15 = -16.8818184926058*c**3 - 9.76812897059426*c**2 + 14.8081666603903*c - 0.346601256982126
    P16 = -16.8922596634366*c**3 - 9.76327857209253*c**2 + 14.8074155835347*c - 0.346562489277403
    P17 = -16.8554605495301*c**3 - 9.78151086025173*c**2 + 14.8104266735463*c - 0.34672825130383
    P18 = -16.9922421772499*c**3 - 9.70951398537727*c**2 + 14.7977944946215*c - 0.345989460232659
    P19 = -15.4959863607073*c**3 - 10.5433365449426*c**2 + 14.9526833518903*c - 0.355580053113044
    P20 = -15.2798281317228*c**3 - 10.670476885105*c**2 + 14.9776105639976*c - 0.357209134549066
    P21 = -15.3365640979027*c**3 - 10.6353521642159*c**2 + 14.9703620989094*c - 0.356710528012172
    P22 = -15.3213440178079*c**3 - 10.6452452161757*c**2 + 14.9725055934614*c - 0.356865335953898
    P23 = -15.3254400406149*c**3 - 10.6424561970925*c**2 + 14.9718725707207*c - 0.356817443627733
    P24 = -15.3243287327932*c**3 - 10.6432472462184*c**2 + 14.9720602650705*c - 0.356832288539408
    P25 = -15.32463609759*c**3 - 10.6430189580424*c**2 + 14.972003746414*c - 0.356827624323159
    P26 = -15.3245554579189*c**3 - 10.6430813437328*c**2 + 14.9720198344003*c - 0.356829007240776
    P27 = -15.3245512407739*c**3 - 10.6430847367155*c**2 + 14.9720207443461*c - 0.356829088586892
    P28 = -15.3246132492204*c**3 - 10.6430329314899*c**2 + 14.9720063173299*c - 0.356827749350487
    P29 = -15.3245341861038*c**3 - 10.6431014291011*c**2 + 14.9720260985487*c - 0.356829653534078
    P30 = -15.3244919436402*c**3 - 10.6431393318926*c**2 + 14.9720374350436*c - 0.356830783755868
    P31 = -15.3249748497619*c**3 - 10.6426911073504*c**2 + 14.9718987569504*c - 0.356816481709757
    P32 = -15.323077545152*c**3 - 10.6445107949548*c**2 + 14.9724805055594*c - 0.356878476128259
    P33 = -15.3301171089988*c**3 - 10.6375416265219*c**2 + 14.9701806800731*c - 0.356625495331173
    P34 = -15.3037956376793*c**3 - 10.6644134554663*c**2 + 14.9793252451345*c - 0.357662803045969
    P35 = -15.402047006588*c**3 - 10.5610708796885*c**2 + 14.9430927115609*c - 0.353428354432253
    P36 = -15.0356099694036*c**3 - 10.9578222535783*c**2 + 15.0862838891335*c - 0.370654687005299
    P37 = -16.4028441775008*c**3 - 9.43522052199114*c**2 + 14.5210756706074*c - 0.300717306461593
    P38 = -11.26017836557*c**3 - 15.321235300682*c**2 + 16.7666794908291*c - 0.586294600358087
    P39 = 54.4069793953095*c**3 - 92.5099943783134*c**2 + 47.0106387294654*c - 4.53633897363034
    P40 = 50.5177900872077*c**3 - 87.8182178221177*c**2 + 45.1239758534648*c - 4.28344991943595
    P41 = 51.5600174242281*c**3 - 89.1077372818254*c**2 + 45.65580493983*c - 4.35656298877439
    P42 = 51.2806954645785*c**3 - 88.753506251378*c**2 + 45.506061822467*c - 4.3354628222296
    P43 = 51.3554360417766*c**3 - 88.8506010557758*c**2 + 45.5481068147637*c - 4.3415317408726
    P44 = 51.335636686068*c**3 - 88.824267912074*c**2 + 45.5364324546535*c - 4.33980652985338
    P45 = 51.3407792632352*c**3 - 88.831266492256*c**2 + 45.539607265091*c - 4.34028659963951
    P46 = 51.3394543294562*c**3 - 88.8294224253623*c**2 + 45.5387517301133*c - 4.34015429414285
    P47 = 51.3399704899057*c**3 - 88.8301567810122*c**2 + 45.5390999924857*c - 4.3402093478071
    P48 = 51.3387853937456*c**3 - 88.828434082563*c**2 + 45.5382652666303*c - 4.34007452694641
    P49 = 51.3429928192636*c**3 - 88.8346801964799*c**2 + 45.5413561466848*c - 4.34058436601481
    P50 = 51.3280515802908*c**3 - 88.8120374281425*c**2 + 45.5299181178561*c - 4.33865838691418
    P51 = 51.3826895484817*c**3 - 88.8965275948867*c**2 + 45.5734689584351*c - 4.34614121306367
    P52 = 51.1800703059416*c**3 - 88.5769417901756*c**2 + 45.4054443004425*c - 4.31669446748128
    P53 = 51.9347655355232*c**3 - 89.7906289360253*c**2 + 46.0560541675659*c - 4.4329499073574
    P54 = 49.1198766723974*c**3 - 85.1767701904755*c**2 + 43.535209525784*c - 3.97385062565445
    P55 = 59.623689930886*c**3 - 102.718138333061*c**2 + 53.2999044580502*c - 5.78574401864171
    P56 = 20.4235291607329*c**3 - 36.0422285131644*c**2 + 15.496684072481*c + 1.35868278348789
    P57 = 1704.50132686994*c**3 - 2952.55877818237*c**2 + 1699.12214683602*c - 322.611671414896
    P58 = 2198.89909888565*c**3 - 3824.0472144899*c**2 + 2211.1876250183*c - 422.90409183866
    P59 = -331.620419022394*c**3 + 714.784611721057*c**2 - 502.483645622735*c + 117.9114048255
    P60 = -1408.39652451756*c**3 + 2679.41156056512*c**2 - 1697.33403541992*c + 360.140165666133
    P61 = -1006.59015128069*c**3 + 1933.87809895037*c**2 - 1236.23288537265*c + 265.078807358383
    P62 = -1051.20106151083*c**3 + 2018.03049779404*c**2 - 1289.14689373603*c + 276.169369717449
    P63 = -1174.29685387941*c**3 + 2254.03870334383*c**2 - 1439.97759237443*c + 308.300879154616
    P64 = -189.790643210814*c**3 + 336.041603832273*c**2 - 194.441900176113*c + 38.6864358837774
    P65 = 148.600821033004*c**3 - 333.665866766358*c**2 + 247.362088761583*c - 58.4658150169125
    P66 = 63.7072736341506*c**3 - 163.029836494941*c**2 + 133.035948479548*c - 32.9329770204931
    P67 = 87.2184668260161*c**3 - 211.014044418233*c**2 + 165.679750536336*c - 40.3355361739086
    P68 = 78.0683174315491*c**3 - 192.056598536321*c**2 + 152.587623516505*c - 37.3217020852026
    P69 = 91.1558880163939*c**3 - 219.576190138934*c**2 + 171.876355448738*c - 41.8282512730802
    P70 = 36.4955980305094*c**3 - 102.951007777941*c**2 + 88.9311121153296*c - 22.164363787786
    P71 = -16.6760764654609*c**3 + 12.1414985628799*c**2 + 5.89012496470241*c - 2.19258697918849
    P72 = -5.35588751337491*c**3 - 12.7114617276238*c**2 + 24.0779731770745*c - 6.6293196491315
    P73 = -8.38847515679663*c**3 - 5.95981887367088*c**2 + 19.0674357991084*c - 5.38984429161064
    P74 = -7.57894889777526*c**3 - 7.78714042028878*c**2 + 20.4423568291822*c - 5.73468559644243
    P75 = -7.78397101932205*c**3 - 7.31801252951846*c**2 + 20.0845401923871*c - 5.6437134273292
    P76 = -7.77228164713597*c**3 - 7.34512124676257*c**2 + 20.1054960517795*c - 5.64911326555011
    P77 = -7.61658554774476*c**3 - 7.71100708004087*c**2 + 20.3921066215844*c - 5.72395046976453
    P78 = -8.24801564158406*c**3 - 6.20762942940928*c**2 + 19.1989714495139*c - 5.40831198351225
    P79 = -5.88121151304222*c**3 - 11.9159306592774*c**2 + 23.7880996812019*c - 6.6381056397513
    P80 = -14.7139647468866*c**3 + 9.66007655824069*c**2 + 6.21999925887212*c - 1.86987474738271
    P81 = 24.9210674751957*c**3 - 88.3825804203516*c**2 + 87.0606264221133*c - 24.0887986372545
    P82 = 74.8027291913168*c**3 - 213.313469536602*c**2 + 191.358989911503*c - 53.1132422145311
    P83 = 64.8195117121795*c**3 - 188.001475400757*c**2 + 169.966519716196*c - 47.0866160150181
    P84 = 67.4937702799798*c**3 - 194.864595343533*c**2 + 175.837606867368*c - 48.7607654117019
    P85 = 66.7806964137417*c**3 - 193.01254803827*c**2 + 174.234182881773*c - 48.2980399241933
    P86 = 66.9589062719897*c**3 - 193.480915947468*c**2 + 174.644501556351*c - 48.4178612664255
    P87 = 66.9585243099136*c**3 - 193.479900275182*c**2 + 174.643601301883*c - 48.4175952820224
    P88 = 66.782449344144*c**3 - 193.006258617446*c**2 + 174.218902615103*c - 48.2906575635279
    P89 = 67.4869271346397*c**3 - 194.923078641965*c**2 + 175.957400291867*c - 48.8162458005463
    P90 = 64.8449290322678*c**3 - 187.652780227363*c**2 + 169.288553836901*c - 46.7771954754353
    P91 = 281.102230997414*c**3 - 789.437872332608*c**2 + 727.489816544025*c - 219.368515187263
    P92 = 428.499007345177*c**3 - 1204.15880214736*c**2 + 1116.44777950678*c - 340.96698946695
    P93 = -69.0121873597218*c**3 + 211.034405335966*c**2 - 225.412689043216*c + 83.1422434717733
    P94 = 2849.84201272384*c**3 - 8181.9981718134*c**2 + 7819.18186899404*c - 2487.06508855575
    P95 = 4236.49461792844*c**3 - 12212.1148798489*c**2 + 11723.5100858394*c - 3747.88703898549
    P96 = 3903.1760238291*c**3 - 11233.0672639081*c**2 + 10764.9334655046*c - 3435.04248743985
    P97 = 3986.50563172986*c**3 - 11480.4046909953*c**2 + 11009.64761685*c - 3515.74872018155

    f = ufl.conditional(ufl.le(c, 0.0106060606060606), P1*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0106060606060606), ufl.le(c, 0.0209090909090909)), P2*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0209090909090909), ufl.le(c, 0.0312121212121212)), P3*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0312121212121212), ufl.le(c, 0.0415151515151515)), P4*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0415151515151515), ufl.le(c, 0.0518181818181818)), P5*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0518181818181818), ufl.le(c, 0.0621212121212121)), P6*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0621212121212121), ufl.le(c, 0.0724242424242424)), P7*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0724242424242424), ufl.le(c, 0.0827272727272727)), P8*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0827272727272727), ufl.le(c, 0.093030303030303)), P9*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.093030303030303), ufl.le(c, 0.103333333333333)), P10*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.103333333333333), ufl.le(c, 0.113636363636364)), P11*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.113636363636364), ufl.le(c, 0.123939393939394)), P12*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.123939393939394), ufl.le(c, 0.134242424242424)), P13*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.134242424242424), ufl.le(c, 0.144545454545455)), P14*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.144545454545455), ufl.le(c, 0.154848484848485)), P15*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.154848484848485), ufl.le(c, 0.165151515151515)), P16*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.165151515151515), ufl.le(c, 0.175454545454545)), P17*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.175454545454545), ufl.le(c, 0.185757575757576)), P18*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.185757575757576), ufl.le(c, 0.196060606060606)), P19*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.196060606060606), ufl.le(c, 0.206363636363636)), P20*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.206363636363636), ufl.le(c, 0.216666666666667)), P21*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.216666666666667), ufl.le(c, 0.226969696969697)), P22*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.226969696969697), ufl.le(c, 0.237272727272727)), P23*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.237272727272727), ufl.le(c, 0.247575757575758)), P24*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.247575757575758), ufl.le(c, 0.257878787878788)), P25*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.257878787878788), ufl.le(c, 0.268181818181818)), P26*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.268181818181818), ufl.le(c, 0.278484848484849)), P27*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.278484848484849), ufl.le(c, 0.288787878787879)), P28*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.288787878787879), ufl.le(c, 0.299090909090909)), P29*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.299090909090909), ufl.le(c, 0.309393939393939)), P30*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.309393939393939), ufl.le(c, 0.31969696969697)), P31*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.31969696969697), ufl.le(c, 0.33)), P32*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.33), ufl.le(c, 0.34030303030303)), P33*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.34030303030303), ufl.le(c, 0.350606060606061)), P34*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.350606060606061), ufl.le(c, 0.360909090909091)), P35*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.360909090909091), ufl.le(c, 0.371212121212121)), P36*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.371212121212121), ufl.le(c, 0.381515151515152)), P37*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.381515151515152), ufl.le(c, 0.391818181818182)), P38*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.391818181818182), ufl.le(c, 0.402121212121212)), P39*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.402121212121212), ufl.le(c, 0.412424242424242)), P40*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.412424242424242), ufl.le(c, 0.422727272727273)), P41*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.422727272727273), ufl.le(c, 0.433030303030303)), P42*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.433030303030303), ufl.le(c, 0.443333333333333)), P43*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.443333333333333), ufl.le(c, 0.453636363636364)), P44*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.453636363636364), ufl.le(c, 0.463939393939394)), P45*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.463939393939394), ufl.le(c, 0.474242424242424)), P46*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.474242424242424), ufl.le(c, 0.484545454545455)), P47*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.484545454545455), ufl.le(c, 0.494848484848485)), P48*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.494848484848485), ufl.le(c, 0.505151515151515)), P49*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.505151515151515), ufl.le(c, 0.515454545454545)), P50*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.515454545454545), ufl.le(c, 0.525757575757576)), P51*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.525757575757576), ufl.le(c, 0.536060606060606)), P52*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.536060606060606), ufl.le(c, 0.546363636363636)), P53*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.546363636363636), ufl.le(c, 0.556666666666667)), P54*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.556666666666667), ufl.le(c, 0.566969696969697)), P55*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.566969696969697), ufl.le(c, 0.577272727272727)), P56*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.577272727272727), ufl.le(c, 0.587575757575758)), P57*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.587575757575758), ufl.le(c, 0.597878787878788)), P58*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.597878787878788), ufl.le(c, 0.608181818181818)), P59*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.608181818181818), ufl.le(c, 0.618484848484849)), P60*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.618484848484849), ufl.le(c, 0.628787878787879)), P61*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.628787878787879), ufl.le(c, 0.639090909090909)), P62*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.639090909090909), ufl.le(c, 0.649393939393939)), P63*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.649393939393939), ufl.le(c, 0.65969696969697)), P64*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.65969696969697), ufl.le(c, 0.67)), P65*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.67), ufl.le(c, 0.68030303030303)), P66*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.68030303030303), ufl.le(c, 0.690606060606061)), P67*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.690606060606061), ufl.le(c, 0.700909090909091)), P68*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.700909090909091), ufl.le(c, 0.711212121212121)), P69*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.711212121212121), ufl.le(c, 0.721515151515152)), P70*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.721515151515152), ufl.le(c, 0.731818181818182)), P71*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.731818181818182), ufl.le(c, 0.742121212121212)), P72*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.742121212121212), ufl.le(c, 0.752424242424242)), P73*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.752424242424242), ufl.le(c, 0.762727272727273)), P74*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.762727272727273), ufl.le(c, 0.773030303030303)), P75*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.773030303030303), ufl.le(c, 0.783333333333333)), P76*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.783333333333333), ufl.le(c, 0.793636363636364)), P77*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.793636363636364), ufl.le(c, 0.803939393939394)), P78*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.803939393939394), ufl.le(c, 0.814242424242424)), P79*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.814242424242424), ufl.le(c, 0.824545454545455)), P80*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.824545454545455), ufl.le(c, 0.834848484848485)), P81*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.834848484848485), ufl.le(c, 0.845151515151515)), P82*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.845151515151515), ufl.le(c, 0.855454545454545)), P83*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.855454545454545), ufl.le(c, 0.865757575757576)), P84*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.865757575757576), ufl.le(c, 0.876060606060606)), P85*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.876060606060606), ufl.le(c, 0.886363636363636)), P86*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.886363636363636), ufl.le(c, 0.896666666666667)), P87*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.896666666666667), ufl.le(c, 0.906969696969697)), P88*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.906969696969697), ufl.le(c, 0.917272727272727)), P89*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.917272727272727), ufl.le(c, 0.927575757575758)), P90*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.927575757575758), ufl.le(c, 0.937878787878788)), P91*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.937878787878788), ufl.le(c, 0.948181818181818)), P92*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.948181818181818), ufl.le(c, 0.958484848484848)), P93*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.958484848484848), ufl.le(c, 0.968787878787879)), P94*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.968787878787879), ufl.le(c, 0.979090909090909)), P95*1e3*(1/vm)/H,
        ufl.conditional(ufl.And(ufl.gt(c, 0.979090909090909), ufl.le(c, 0.989393939393939)), P96*1e3*(1/vm)/H,P97*1e3*(1/vm)/H))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

    return f

def regsol_spl(c):

    P1 = (-90682450817.7449*c**3 + 6275138225.57029*c**2 - 97031706.3681518*c - 20723.533137449)/H
    P2 = (279699573.588837*c**3 + 736094552.49802*c**2 + 15399690.207997*c - 781433.60525789)/H
    P3 = (-11201806726.6865*c**3 + 1783103549.75313*c**2 - 16426210.5540211*c - 458963.291577283)/H
    P4 = (-3445700588.49652*c**3 + 840830667.370766*c**2 + 21732034.0193026*c - 974048.201741971)/H
    P5 = (-3286351571.65112*c**3 + 816643900.992706*c**2 + 22955762.24265*c - 994686.357627258)/H
    P6 = (-2083475915.86011*c**3 + 597622114.539642*c**2 + 36249057.2755823*c - 1263627.17198557)/H
    P7 = (-1640671963.94812*c**3 + 503579947.96463*c**2 + 42906577.7244816*c - 1420728.96345371)/H
    P8 = (-1255485395.44714*c**3 + 410104505.645569*c**2 + 50467985.6509705*c - 1624614.56310976)/H
    P9 = (-1009224541.68823*c**3 + 342882008.774536*c**2 + 56584621.752655*c - 1810133.98959899)/H
    P10 = (-822823667.645996*c**3 + 286352272.188904*c**2 + 62299207.114006*c - 2002696.27524948)/H
    P11 = (-684509482.430176*c**3 + 240215270.473755*c**2 + 67429129.0713348*c - 2192826.38275743)/H
    P12 = (-577372097.183838*c**3 + 201231871.887451*c**2 + 72157342.793869*c - 2383984.72037697)/H
    P13 = (-493156436.712891*c**3 + 168037376.116333*c**2 + 76518663.6508331*c - 2574991.48395443)/H
    P14 = (-425611869.018555*c**3 + 139367572.658081*c**2 + 80575035.4086914*c - 2766297.89759064)/H
    P15 = (-370630756.763428*c**3 + 114364661.945679*c**2 + 84365097.8406982*c - 2957803.24409103)/H
    P16 = (-325252985.625*c**3 + 92354105.3005371*c**2 + 87923849.1239929*c - 3149600.76654434)/H
    P17 = (-287352064.621582*c**3 + 72821923.0874023*c**2 + 91279142.6273193*c - 3341728.03577995)/H
    P18 = (-255354974.074219*c**3 + 55362856.0710449*c**2 + 94454629.47995*c - 3534249.14322853)/H
    P19 = (-228081080.220215*c**3 + 39654663.5253906*c**2 + 97470300.9780273*c - 3727232.82694244)/H
    P20 = (-204629984.265625*c**3 + 25437685.3271484*c**2 + 100343265.060364*c - 3920755.49406052)/H
    P21 = (-184305085.19043*c**3 + 12500147.9790039*c**2 + 103088336.053223*c - 4114904.10601425)/H
    P22 = (-166560261.105957*c**3 + 667307.787109375*c**2 + 105718513.475891*c - 4309780.77022552)/H
    P23 = (-150963429.700195*c**3 - 10205716.019043*c**2 + 108245151.6026*c - 4505491.43723297)/H
    P24 = (-137167577.577637*c**3 - 20241195.1035156*c**2 + 110678511.996338*c - 4702168.40555573)/H
    P25 = (-124893091.467773*c**3 - 29541870.7910156*c**2 + 113027627.809814*c - 4899944.18333435)/H
    P26 = (-113910753.916992*c**3 - 38196185.7392578*c**2 + 115300889.061768*c - 5098986.19306183)/H
    P27 = (-104033047.293457*c**3 - 46279292.6674805*c**2 + 117505740.182495*c - 5299460.6108551)/H
    P28 = (-95103147.2348633*c**3 - 53857341.15625*c**2 + 119649355.771973*c - 5501583.35174561)/H
    P29 = (-86991484.777832*c**3 - 60986779.6137695*c**2 + 121738072.398193*c - 5705560.9473877)/H
    P30 = (-79588527.6206055*c**3 - 67717615.5625*c**2 + 123777984.808716*c - 5911639.49273682)/H
    P31 = (-72799866.784668*c**3 - 74095603.5600586*c**2 + 125775370.935059*c - 6120145.75613403)/H
    P32 = (-66549183.0942383*c**3 - 80157535.5458984*c**2 + 127734997.604736*c - 6331307.07644653)/H
    P33 = (-60766046.0180664*c**3 - 85941250.934082*c**2 + 129663095.524414*c - 6545561.60195923)/H
    P34 = (-55393474.2939453*c**3 - 91477132.5576172*c**2 + 131564480.742432*c - 6763248.44262695)/H
    P35 = (-50379240.5595703*c**3 - 96795699.8867188*c**2 + 133444938.120361*c - 6984869.52539063)/H
    P36 = (-45681806.1538086*c**3 - 101920558.125*c**2 + 135308662.702148*c - 7210792.47817993)/H
    P37 = (-41258590.8974609*c**3 - 106880255.776367*c**2 + 137162412.321533*c - 7441746.58685303)/H
    P38 = (-37077886.3974609*c**3 - 111694691.733398*c**2 + 139010489.488037*c - 7678215.21633911)/H
    P39 = (-33107665.1005859*c**3 - 116387024.097656*c**2 + 140859083.590332*c - 7920972.96734619)/H
    P40 = (-29322763.2578125*c**3 - 120975001.827148*c**2 + 142712900.018555*c - 8170657.07269287)/H
    P41 = (-25692043.8720703*c**3 - 125486082.645508*c**2 + 144581202.871094*c - 8428581.62860107)/H
    P42 = (-22203857.9980469*c**3 - 129925750.496094*c**2 + 146464765.589355*c - 8694953.54626465)/H
    P43 = (-18825471.4257813*c**3 - 134328023.660156*c**2 + 148376921.843262*c - 8971806.08721924)/H
    P44 = (-15546019.1728516*c**3 - 138700735.980469*c**2 + 150320398.126953*c - 9259735.69812012)/H
    P45 = (-12347590.9902344*c**3 - 143062316.19043*c**2 + 152302974.236328*c - 9560132.02526855)/H
    P46 = (-9204878.91699219*c**3 - 147443133.016602*c**2 + 154338536.262695*c - 9875409.05584717)/H
    P47 = (-6111930.59863281*c**3 - 151848288.082031*c**2 + 156429894.754883*c - 10206368.2973022)/H
    P48 = (-3050398.00097656*c**3 - 156301454.244141*c**2 + 158589019.114746*c - 10555319.869751)/H
    P49 = (1472.69921875*c**3 - 160833029.074219*c**2 + 160831924.368164*c - 10925362.2327881)/H
    P50 = (3048536.44433594*c**3 - 165449783.089844*c**2 + 163163613.650391*c - 11317901.7312012)/H
    P51 = (6111780.44140625*c**3 - 170183859.607422*c**2 + 165602365.994141*c - 11736674.9226074)/H
    P52 = (9206277.30761719*c**3 - 175059989.599609*c**2 + 168163540.958496*c - 12185091.8170166)/H
    P53 = (12346168.8261719*c**3 - 180102779.070313*c**2 + 170863180.476563*c - 12666839.3066406)/H
    P54 = (15546290.5498047*c**3 - 185339254.614258*c**2 + 173719392.258789*c - 13186141.8846436)/H
    P55 = (18827293.3330078*c**3 - 190807483.213867*c**2 + 176757236.28125*c - 13748694.3410645)/H
    P56 = (22200090.2890625*c**3 - 196530884.575195*c**2 + 179994640.677734*c - 14359099.855957)/H
    P57 = (25695580.3261719*c**3 - 202568390.310547*c**2 + 183470688.869141*c - 15026202.6594238)/H
    P58 = (29322234.8964844*c**3 - 208942323.625977*c**2 + 187204802.978516*c - 15755402.2225342)/H
    P59 = (33105233.1206055*c**3 - 215705648.09375*c**2 + 191235341.290039*c - 16556055.7667236)/H
    P60 = (37081338.9648438*c**3 - 222934678.423828*c**2 + 195616418.451172*c - 17441090.8830566)/H
    P61 = (41253467.5288086*c**3 - 230646504.084961*c**2 + 200367970.24707*c - 18416962.0305176)/H
    P62 = (45690338.6328125*c**3 - 238982107.598633*c**2 + 205588036.708008*c - 19506628.9332275)/H
    P63 = (50369154.7587891*c**3 - 247914010.12207*c**2 + 211271731.077148*c - 20712209.4030762)/H
    P64 = (55400713.3320313*c**3 - 257671742.15332*c**2 + 217579474.03418*c - 22071392.0855713)/H
    P65 = (60763723.9741211*c**3 - 268234744.166992*c**2 + 224514447.620117*c - 23589074.862793)/H
    P66 = (66546920.9614258*c**3 - 279800559.823242*c**2 + 232224605.866211*c - 25302357.6938477)/H
    P67 = (72806150.4599609*c**3 - 292508028.580078*c**2 + 240824160.727539*c - 27242223.2729492)/H
    P68 = (79580876.1323242*c**3 - 306467309.780273*c**2 + 250411832.154297*c - 29437260.9257813)/H
    P69 = (86996177.3686523*c**3 - 321971154.185547*c**2 + 261216931.137695*c - 31947394.5617676)/H
    P70 = (95103096.4648438*c**3 - 339166642.021484*c**2 + 273374644.742188*c - 34812681.1130371)/H
    P71 = (104031133.612305*c**3 - 358374285.865234*c**2 + 287148989.385742*c - 38105338.4865723)/H
    P72 = (113910620.729492*c**3 - 379928183.28125*c**2 + 302823571.424805*c - 41904999.6687012)/H
    P73 = (124897589.619141*c**3 - 404231125.410156*c**2 + 320742768.911133*c - 46309097.9729004)/H
    P74 = (137158102.806152*c**3 - 431722576.899414*c**2 + 341290573.989258*c - 51428414.1064453)/H
    P75 = (150975423.933105*c**3 - 463123444.048828*c**2 + 365077492.092773*c - 57434803.1447754)/H
    P76 = (166550868.442383*c**3 - 498991663.229492*c**2 + 392610770.431641*c - 64479864.5168457)/H
    P77 = (184310748.876953*c**3 - 540428424.268555*c**2 + 424837060.308594*c - 72834231.7749023)/H
    P78 = (204624716.169922*c**3 - 588439747.274414*c**2 + 462661398.995117*c - 82767170.5605469)/H
    P79 = (228086713.897461*c**3 - 644602153.173828*c**2 + 507474517.255371*c - 94686268.0180664)/H
    P80 = (255350944.662109*c**3 - 710692218.308594*c**2 + 560876558.274414*c - 109069559.361816)/H
    P81 = (287352997.331055*c**3 - 789236601.738281*c**2 + 625135146.44043*c - 126593265.80127)/H
    P82 = (325254656.926758*c**3 - 883409017.680664*c**2 + 703130358.430176*c - 148125590.427368)/H
    P83 = (370630523.964111*c**3 - 997526985.733887*c**2 + 798797295.37793*c - 174858636.886597)/H
    P84 = (425608823.444336*c**3 - 1137460252.58936*c**2 + 917518799.174316*c - 208433677.763794)/H
    P85 = (493158530.394775*c**3 - 1311437388.58203*c**2 + 1066880630.70947*c - 251176759.283813)/H
    P86 = (577372699.695557*c**3 - 1530885988.47266*c**2 + 1257496566.22559*c - 306367260.825928)/H
    P87 = (684508654.427002*c**3 - 1813310974.59717*c**2 + 1505666824.86377*c - 379057332.28833)/H
    P88 = (822824916.969482*c**3 - 2182122067.57861*c**2 + 1833470222.20825*c - 476175766.228271)/H
    P89 = (1009221675.85571*c**3 - 2684783855.65576*c**2 + 2285317980.90161*c - 611565937.698242)/H
    P90 = (1255488258.62744*c**3 - 3356359543.23364*c**2 + 2895786386.14453*c - 796539714.391541)/H
    P91 = (1640670652.50928*c**3 - 4418432295.64063*c**2 + 3871946035.28674*c - 1095605121.61951)/H
    P92 = (2083476020.77271*c**3 - 5652805933.05139*c**2 + 5018934747.06519*c - 1450868461.95471)/H
    P93 = (3286352076.85022*c**3 - 9042412241.9472*c**2 + 8202812496.07867*c - 2447747017.24707)/H
    P94 = (3445700161.50959*c**3 - 9496269871.03845*c**2 + 8633707221.34857*c - 2584111560.04952)/H
    P95 = (11201806578.8462*c**3 - 31822316206.7528*c**2 + 30055638886.7139*c - 9435588222.10875)/H
    P96 = (-279699277.98143*c**3 + 1575192406.91345*c**2 - 2326686669.66827*c + 1030412107.13377)/H
    P97 = (90682450786.9056*c**3 - 265772214134.554*c**2 + 259594107614.778*c - 84504364990.6628)/H

    f = ufl.conditional(ufl.le(c, 0.0202979797979798), P1,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0202979797979798), ufl.le(c, 0.0303969696969697)), P2,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0303969696969697), ufl.le(c, 0.0404959595959596)), P3,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0404959595959596), ufl.le(c, 0.0505949494949495)), P4,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0505949494949495), ufl.le(c, 0.0606939393939394)), P5,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0606939393939394), ufl.le(c, 0.0707929292929293)), P6,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0707929292929293), ufl.le(c, 0.0808919191919192)), P7,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0808919191919192), ufl.le(c, 0.0909909090909091)), P8,
        ufl.conditional(ufl.And(ufl.gt(c, 0.0909909090909091), ufl.le(c, 0.101089898989899)), P9,
        ufl.conditional(ufl.And(ufl.gt(c, 0.101089898989899), ufl.le(c, 0.111188888888889)), P10,
        ufl.conditional(ufl.And(ufl.gt(c, 0.111188888888889), ufl.le(c, 0.121287878787879)), P11,
        ufl.conditional(ufl.And(ufl.gt(c, 0.121287878787879), ufl.le(c, 0.131386868686869)), P12,
        ufl.conditional(ufl.And(ufl.gt(c, 0.131386868686869), ufl.le(c, 0.141485858585859)), P13,
        ufl.conditional(ufl.And(ufl.gt(c, 0.141485858585859), ufl.le(c, 0.151584848484848)), P14,
        ufl.conditional(ufl.And(ufl.gt(c, 0.151584848484848), ufl.le(c, 0.161683838383838)), P15,
        ufl.conditional(ufl.And(ufl.gt(c, 0.161683838383838), ufl.le(c, 0.171782828282828)), P16,
        ufl.conditional(ufl.And(ufl.gt(c, 0.171782828282828), ufl.le(c, 0.181881818181818)), P17,
        ufl.conditional(ufl.And(ufl.gt(c, 0.181881818181818), ufl.le(c, 0.191980808080808)), P18,
        ufl.conditional(ufl.And(ufl.gt(c, 0.191980808080808), ufl.le(c, 0.202079797979798)), P19,
        ufl.conditional(ufl.And(ufl.gt(c, 0.202079797979798), ufl.le(c, 0.212178787878788)), P20,
        ufl.conditional(ufl.And(ufl.gt(c, 0.212178787878788), ufl.le(c, 0.222277777777778)), P21,
        ufl.conditional(ufl.And(ufl.gt(c, 0.222277777777778), ufl.le(c, 0.232376767676768)), P22,
        ufl.conditional(ufl.And(ufl.gt(c, 0.232376767676768), ufl.le(c, 0.242475757575758)), P23,
        ufl.conditional(ufl.And(ufl.gt(c, 0.242475757575758), ufl.le(c, 0.252574747474747)), P24,
        ufl.conditional(ufl.And(ufl.gt(c, 0.252574747474747), ufl.le(c, 0.262673737373737)), P25,
        ufl.conditional(ufl.And(ufl.gt(c, 0.262673737373737), ufl.le(c, 0.272772727272727)), P26,
        ufl.conditional(ufl.And(ufl.gt(c, 0.272772727272727), ufl.le(c, 0.282871717171717)), P27,
        ufl.conditional(ufl.And(ufl.gt(c, 0.282871717171717), ufl.le(c, 0.292970707070707)), P28,
        ufl.conditional(ufl.And(ufl.gt(c, 0.292970707070707), ufl.le(c, 0.303069696969697)), P29,
        ufl.conditional(ufl.And(ufl.gt(c, 0.303069696969697), ufl.le(c, 0.313168686868687)), P30,
        ufl.conditional(ufl.And(ufl.gt(c, 0.313168686868687), ufl.le(c, 0.323267676767677)), P31,
        ufl.conditional(ufl.And(ufl.gt(c, 0.323267676767677), ufl.le(c, 0.333366666666667)), P32,
        ufl.conditional(ufl.And(ufl.gt(c, 0.333366666666667), ufl.le(c, 0.343465656565657)), P33,
        ufl.conditional(ufl.And(ufl.gt(c, 0.343465656565657), ufl.le(c, 0.353564646464646)), P34,
        ufl.conditional(ufl.And(ufl.gt(c, 0.353564646464646), ufl.le(c, 0.363663636363636)), P35,
        ufl.conditional(ufl.And(ufl.gt(c, 0.363663636363636), ufl.le(c, 0.373762626262626)), P36,
        ufl.conditional(ufl.And(ufl.gt(c, 0.373762626262626), ufl.le(c, 0.383861616161616)), P37,
        ufl.conditional(ufl.And(ufl.gt(c, 0.383861616161616), ufl.le(c, 0.393960606060606)), P38,
        ufl.conditional(ufl.And(ufl.gt(c, 0.393960606060606), ufl.le(c, 0.404059595959596)), P39,
        ufl.conditional(ufl.And(ufl.gt(c, 0.404059595959596), ufl.le(c, 0.414158585858586)), P40,
        ufl.conditional(ufl.And(ufl.gt(c, 0.414158585858586), ufl.le(c, 0.424257575757576)), P41,
        ufl.conditional(ufl.And(ufl.gt(c, 0.424257575757576), ufl.le(c, 0.434356565656566)), P42,
        ufl.conditional(ufl.And(ufl.gt(c, 0.434356565656566), ufl.le(c, 0.444455555555556)), P43,
        ufl.conditional(ufl.And(ufl.gt(c, 0.444455555555556), ufl.le(c, 0.454554545454545)), P44,
        ufl.conditional(ufl.And(ufl.gt(c, 0.454554545454545), ufl.le(c, 0.464653535353535)), P45,
        ufl.conditional(ufl.And(ufl.gt(c, 0.464653535353535), ufl.le(c, 0.474752525252525)), P46,
        ufl.conditional(ufl.And(ufl.gt(c, 0.474752525252525), ufl.le(c, 0.484851515151515)), P47,
        ufl.conditional(ufl.And(ufl.gt(c, 0.484851515151515), ufl.le(c, 0.494950505050505)), P48,
        ufl.conditional(ufl.And(ufl.gt(c, 0.494950505050505), ufl.le(c, 0.505049494949495)), P49,
        ufl.conditional(ufl.And(ufl.gt(c, 0.505049494949495), ufl.le(c, 0.515148484848485)), P50,
        ufl.conditional(ufl.And(ufl.gt(c, 0.515148484848485), ufl.le(c, 0.525247474747475)), P51,
        ufl.conditional(ufl.And(ufl.gt(c, 0.525247474747475), ufl.le(c, 0.535346464646465)), P52,
        ufl.conditional(ufl.And(ufl.gt(c, 0.535346464646465), ufl.le(c, 0.545445454545455)), P53,
        ufl.conditional(ufl.And(ufl.gt(c, 0.545445454545455), ufl.le(c, 0.555544444444444)), P54,
        ufl.conditional(ufl.And(ufl.gt(c, 0.555544444444444), ufl.le(c, 0.565643434343434)), P55,
        ufl.conditional(ufl.And(ufl.gt(c, 0.565643434343434), ufl.le(c, 0.575742424242424)), P56,
        ufl.conditional(ufl.And(ufl.gt(c, 0.575742424242424), ufl.le(c, 0.585841414141414)), P57,
        ufl.conditional(ufl.And(ufl.gt(c, 0.585841414141414), ufl.le(c, 0.595940404040404)), P58,
        ufl.conditional(ufl.And(ufl.gt(c, 0.595940404040404), ufl.le(c, 0.606039393939394)), P59,
        ufl.conditional(ufl.And(ufl.gt(c, 0.606039393939394), ufl.le(c, 0.616138383838384)), P60,
        ufl.conditional(ufl.And(ufl.gt(c, 0.616138383838384), ufl.le(c, 0.626237373737374)), P61,
        ufl.conditional(ufl.And(ufl.gt(c, 0.626237373737374), ufl.le(c, 0.636336363636364)), P62,
        ufl.conditional(ufl.And(ufl.gt(c, 0.636336363636364), ufl.le(c, 0.646435353535354)), P63,
        ufl.conditional(ufl.And(ufl.gt(c, 0.646435353535354), ufl.le(c, 0.656534343434343)), P64,
        ufl.conditional(ufl.And(ufl.gt(c, 0.656534343434343), ufl.le(c, 0.666633333333333)), P65,
        ufl.conditional(ufl.And(ufl.gt(c, 0.666633333333333), ufl.le(c, 0.676732323232323)), P66,
        ufl.conditional(ufl.And(ufl.gt(c, 0.676732323232323), ufl.le(c, 0.686831313131313)), P67,
        ufl.conditional(ufl.And(ufl.gt(c, 0.686831313131313), ufl.le(c, 0.696930303030303)), P68,
        ufl.conditional(ufl.And(ufl.gt(c, 0.696930303030303), ufl.le(c, 0.707029292929293)), P69,
        ufl.conditional(ufl.And(ufl.gt(c, 0.707029292929293), ufl.le(c, 0.717128282828283)), P70,
        ufl.conditional(ufl.And(ufl.gt(c, 0.717128282828283), ufl.le(c, 0.727227272727273)), P71,
        ufl.conditional(ufl.And(ufl.gt(c, 0.727227272727273), ufl.le(c, 0.737326262626263)), P72,
        ufl.conditional(ufl.And(ufl.gt(c, 0.737326262626263), ufl.le(c, 0.747425252525252)), P73,
        ufl.conditional(ufl.And(ufl.gt(c, 0.747425252525252), ufl.le(c, 0.757524242424242)), P74,
        ufl.conditional(ufl.And(ufl.gt(c, 0.757524242424242), ufl.le(c, 0.767623232323232)), P75,
        ufl.conditional(ufl.And(ufl.gt(c, 0.767623232323232), ufl.le(c, 0.777722222222222)), P76,
        ufl.conditional(ufl.And(ufl.gt(c, 0.777722222222222), ufl.le(c, 0.787821212121212)), P77,
        ufl.conditional(ufl.And(ufl.gt(c, 0.787821212121212), ufl.le(c, 0.797920202020202)), P78,
        ufl.conditional(ufl.And(ufl.gt(c, 0.797920202020202), ufl.le(c, 0.808019191919192)), P79,
        ufl.conditional(ufl.And(ufl.gt(c, 0.808019191919192), ufl.le(c, 0.818118181818182)), P80,
        ufl.conditional(ufl.And(ufl.gt(c, 0.818118181818182), ufl.le(c, 0.828217171717172)), P81,
        ufl.conditional(ufl.And(ufl.gt(c, 0.828217171717172), ufl.le(c, 0.838316161616162)), P82,
        ufl.conditional(ufl.And(ufl.gt(c, 0.838316161616162), ufl.le(c, 0.848415151515151)), P83,
        ufl.conditional(ufl.And(ufl.gt(c, 0.848415151515151), ufl.le(c, 0.858514141414141)), P84,
        ufl.conditional(ufl.And(ufl.gt(c, 0.858514141414141), ufl.le(c, 0.868613131313131)), P85,
        ufl.conditional(ufl.And(ufl.gt(c, 0.868613131313131), ufl.le(c, 0.878712121212121)), P86,
        ufl.conditional(ufl.And(ufl.gt(c, 0.878712121212121), ufl.le(c, 0.888811111111111)), P87,
        ufl.conditional(ufl.And(ufl.gt(c, 0.888811111111111), ufl.le(c, 0.898910101010101)), P88,
        ufl.conditional(ufl.And(ufl.gt(c, 0.898910101010101), ufl.le(c, 0.909009090909091)), P89,
        ufl.conditional(ufl.And(ufl.gt(c, 0.909009090909091), ufl.le(c, 0.919108080808081)), P90,
        ufl.conditional(ufl.And(ufl.gt(c, 0.919108080808081), ufl.le(c, 0.929207070707071)), P91,
        ufl.conditional(ufl.And(ufl.gt(c, 0.929207070707071), ufl.le(c, 0.939306060606061)), P92,
        ufl.conditional(ufl.And(ufl.gt(c, 0.939306060606061), ufl.le(c, 0.949405050505051)), P93,
        ufl.conditional(ufl.And(ufl.gt(c, 0.949405050505051), ufl.le(c, 0.95950404040404)), P94,
        ufl.conditional(ufl.And(ufl.gt(c, 0.95950404040404), ufl.le(c, 0.96960303030303)), P95,
        ufl.conditional(ufl.And(ufl.gt(c, 0.96960303030303), ufl.le(c, 0.97970202020202)), P96,P97))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

    return f
